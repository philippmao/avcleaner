//
// Created by vladimir on 28.09.19.
//

#include <Windows.h>
#include <stdio.h>


 char  hid_core_l_r2m0XYrGM3GG[] = {'\x26','\x2a','\x37','\x20','\x1a','\x29','\x2a','\x24','\x21','\x29','\x2c','\x27','\x45'};
 char k_O1xsYkleS8UB = '\x45';
for(int i = 0; i < sizeof(hid_core_l_r2m0XYrGM3GG) / sizeof(hid_core_l_r2m0XYrGM3GG[0]); i++){
hid_core_l_r2m0XYrGM3GG[i] = hid_core_l_r2m0XYrGM3GG[i] ^ k_O1xsYkleS8UB;
}

 char  hid_reques_ZSu51m7IKSTt[] = {'\x37','\x20','\x34','\x30','\x20','\x36','\x31','\x1a','\x26','\x2a','\x37','\x20','\x1a','\x29','\x2a','\x24','\x21','\x29','\x2c','\x27','\x45'};
 char k_PjEeJZp2OrEe = '\x45';
for(int i = 0; i < sizeof(hid_reques_ZSu51m7IKSTt) / sizeof(hid_reques_ZSu51m7IKSTt[0]); i++){
hid_reques_ZSu51m7IKSTt[i] = hid_reques_ZSu51m7IKSTt[i] ^ k_PjEeJZp2OrEe;
}

 char  hid_core_e_jrdDyMnZsoWu[] = {'\x26','\x2a','\x37','\x20','\x1a','\x20','\x2b','\x30','\x28','\x20','\x3d','\x31','\x26','\x28','\x21','\x45'};
 char k_lxywWfZI9SZS = '\x45';
for(int i = 0; i < sizeof(hid_core_e_jrdDyMnZsoWu) / sizeof(hid_core_e_jrdDyMnZsoWu[0]); i++){
hid_core_e_jrdDyMnZsoWu[i] = hid_core_e_jrdDyMnZsoWu[i] ^ k_lxywWfZI9SZS;
}

 char  hid_reques_oJo8yPsBSKzA[] = {'\x37','\x20','\x34','\x30','\x20','\x36','\x31','\x1a','\x26','\x2a','\x37','\x20','\x1a','\x20','\x2b','\x30','\x28','\x20','\x3d','\x31','\x26','\x28','\x21','\x45'};
 char k_VCZ2XNxxfeaY = '\x45';
for(int i = 0; i < sizeof(hid_reques_oJo8yPsBSKzA) / sizeof(hid_reques_oJo8yPsBSKzA[0]); i++){
hid_reques_oJo8yPsBSKzA[i] = hid_reques_oJo8yPsBSKzA[i] ^ k_VCZ2XNxxfeaY;
}

 char  hid_core_m_qvenzAIdnmlQ[] = {'\x26','\x2a','\x37','\x20','\x1a','\x28','\x24','\x26','\x2d','\x2c','\x2b','\x20','\x1a','\x2c','\x21','\x45'};
 char k_DXutJioHi5U5 = '\x45';
for(int i = 0; i < sizeof(hid_core_m_qvenzAIdnmlQ) / sizeof(hid_core_m_qvenzAIdnmlQ[0]); i++){
hid_core_m_qvenzAIdnmlQ[i] = hid_core_m_qvenzAIdnmlQ[i] ^ k_DXutJioHi5U5;
}

 char  hid_reques_yxpoNLL5bP5b[] = {'\x37','\x20','\x34','\x30','\x20','\x36','\x31','\x1a','\x26','\x2a','\x37','\x20','\x1a','\x28','\x24','\x26','\x2d','\x2c','\x2b','\x20','\x1a','\x2c','\x21','\x45'};
 char k_mPmleSIu8mJv = '\x45';
for(int i = 0; i < sizeof(hid_reques_yxpoNLL5bP5b) / sizeof(hid_reques_yxpoNLL5bP5b[0]); i++){
hid_reques_yxpoNLL5bP5b[i] = hid_reques_yxpoNLL5bP5b[i] ^ k_mPmleSIu8mJv;
}

 char  hid_core_g_QqLQuRXdIMG1[] = {'\x26','\x2a','\x37','\x20','\x1a','\x22','\x20','\x31','\x1a','\x36','\x20','\x36','\x36','\x2c','\x2a','\x2b','\x1a','\x22','\x30','\x2c','\x21','\x45'};
 char k_VUQa4o9co1OO = '\x45';
for(int i = 0; i < sizeof(hid_core_g_QqLQuRXdIMG1) / sizeof(hid_core_g_QqLQuRXdIMG1[0]); i++){
hid_core_g_QqLQuRXdIMG1[i] = hid_core_g_QqLQuRXdIMG1[i] ^ k_VUQa4o9co1OO;
}

 char  hid_reques_0gkYokKPh3qi[] = {'\x37','\x20','\x34','\x30','\x20','\x36','\x31','\x1a','\x26','\x2a','\x37','\x20','\x1a','\x22','\x20','\x31','\x1a','\x36','\x20','\x36','\x36','\x2c','\x2a','\x2b','\x1a','\x22','\x30','\x2c','\x21','\x45'};
 char k_lSdPUQXbTTdn = '\x45';
for(int i = 0; i < sizeof(hid_reques_0gkYokKPh3qi) / sizeof(hid_reques_0gkYokKPh3qi[0]); i++){
hid_reques_0gkYokKPh3qi[i] = hid_reques_0gkYokKPh3qi[i] ^ k_lSdPUQXbTTdn;
}
char *customCommands[] =
{
	hid_core_l_r2m0XYrGM3GG,
    hid_reques_ZSu51m7IKSTt,
	hid_core_e_jrdDyMnZsoWu,
    hid_reques_oJo8yPsBSKzA,
	hid_core_m_qvenzAIdnmlQ,
    hid_reques_yxpoNLL5bP5b,
	hid_core_g_QqLQuRXdIMG1,
    hid_reques_0gkYokKPh3qi
};

typedef NTSTATUS (NTAPI *f_NtMapViewOfSection)(HANDLE, HANDLE, PVOID *, ULONG, ULONG,
PLARGE_INTEGER, PULONG, ULONG, ULONG, ULONG);
typedef NTSTATUS (* PKUHL_M_C_FUNC) (int argc, wchar_t * args[]);
typedef NTSTATUS (* PKUHL_M_C_FUNC_INIT) ();

typedef struct _KUHL_M_C {
    const PKUHL_M_C_FUNC pCommand;
    const wchar_t * command;
    const wchar_t * description;
} KUHL_M_C, *PKUHL_M_C;

int main(void)
{

    
	 char  hid_Someth_stJfcgYpvJet[] = {'\x16','\x2a','\x28','\x20','\x31','\x2d','\x2c','\x2b','\x22','\x45'};
 char k_bKzcbZcaAZDC = '\x45';
for(int i = 0; i < sizeof(hid_Someth_stJfcgYpvJet) / sizeof(hid_Someth_stJfcgYpvJet[0]); i++){
hid_Someth_stJfcgYpvJet[i] = hid_Someth_stJfcgYpvJet[i] ^ k_bKzcbZcaAZDC;
}

	 wchar_t  hid_n_t_d__oFgOnee1Aswg[] = {'\x2b','\x31','\x21','\x29','\x29','\x45'};
 wchar_t k_Ksf2DZlAmYCo = '\x45';
for(int i = 0; i < sizeof(hid_n_t_d__oFgOnee1Aswg) / sizeof(hid_n_t_d__oFgOnee1Aswg[0]); i++){
hid_n_t_d__oFgOnee1Aswg[i] = hid_n_t_d__oFgOnee1Aswg[i] ^ k_Ksf2DZlAmYCo;
}

	 char  hid_NtMapV_IMIEGotOcjhL[] = {'\xb','\x31','\x8','\x24','\x35','\x13','\x2c','\x20','\x32','\xa','\x23','\x16','\x20','\x26','\x31','\x2c','\x2a','\x2b','\x45'};
 char k_ZCpi3eWrlCO1 = '\x45';
for(int i = 0; i < sizeof(hid_NtMapV_IMIEGotOcjhL) / sizeof(hid_NtMapV_IMIEGotOcjhL[0]); i++){
hid_NtMapV_IMIEGotOcjhL[i] = hid_NtMapV_IMIEGotOcjhL[i] ^ k_ZCpi3eWrlCO1;
}

	 char  hid_____At_xJm6meSWRsVt[] = {'\x1e','\x6f','\x18','\x65','\x4','\x31','\x31','\x20','\x28','\x35','\x31','\x2c','\x2b','\x22','\x65','\x31','\x2a','\x65','\x24','\x21','\x21','\x65','\x30','\x36','\x20','\x37','\x65','\x60','\x36','\x65','\x31','\x2a','\x65','\x2d','\x2a','\x36','\x31','\x65','\x60','\x36','\x4f','\x45'};
 char k_paNiLgzP8jGP = '\x45';
for(int i = 0; i < sizeof(hid_____At_xJm6meSWRsVt) / sizeof(hid_____At_xJm6meSWRsVt[0]); i++){
hid_____At_xJm6meSWRsVt[i] = hid_____At_xJm6meSWRsVt[i] ^ k_paNiLgzP8jGP;
}

	 char  hid_userna_Ieu2HHqcBt5t[] = {'\x30','\x36','\x20','\x37','\x2b','\x24','\x28','\x20','\x45'};
 char k_CmNMSbhXpdZc = '\x45';
for(int i = 0; i < sizeof(hid_userna_Ieu2HHqcBt5t) / sizeof(hid_userna_Ieu2HHqcBt5t[0]); i++){
hid_userna_Ieu2HHqcBt5t[i] = hid_userna_Ieu2HHqcBt5t[i] ^ k_CmNMSbhXpdZc;
}

	 char  hid_dc_net_l1eEndAbTT0e[] = {'\x21','\x26','\x1a','\x2b','\x20','\x31','\x27','\x2c','\x2a','\x36','\x1a','\x2b','\x24','\x28','\x20','\x45'};
 char k_zqOfLxDe1Dx2 = '\x45';
for(int i = 0; i < sizeof(hid_dc_net_l1eEndAbTT0e) / sizeof(hid_dc_net_l1eEndAbTT0e[0]); i++){
hid_dc_net_l1eEndAbTT0e[i] = hid_dc_net_l1eEndAbTT0e[i] ^ k_zqOfLxDe1Dx2;
}
	typedef int (*_MessageBoxA)(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType);
	TCHAR  hid_User___KYkFp67bkIGF[] = {'\x10','\x36','\x20','\x37','\x76','\x77','\x6b','\x21','\x29','\x29','\x45'};
TCHAR k_akU7BZchjS57 = '\x45';
for(int i = 0; i < sizeof(hid_User___KYkFp67bkIGF) / sizeof(hid_User___KYkFp67bkIGF[0]); i++){
hid_User___KYkFp67bkIGF[i] = hid_User___KYkFp67bkIGF[i] ^ k_akU7BZchjS57;
}

	HMODULE hid_hHandl_jdWE73WT9RW9 = LoadLibrary(hid_User___KYkFp67bkIGF);
	char  hid_Messag_aMfLqtukSkIT[] = {'\x8','\x20','\x36','\x36','\x24','\x22','\x20','\x7','\x2a','\x3d','\x4','\x45'};
char k_4CjvAa4ly7Yb = '\x45';
for(int i = 0; i < sizeof(hid_Messag_aMfLqtukSkIT) / sizeof(hid_Messag_aMfLqtukSkIT[0]); i++){
hid_Messag_aMfLqtukSkIT[i] = hid_Messag_aMfLqtukSkIT[i] ^ k_4CjvAa4ly7Yb;
}

	_MessageBoxA hid_Messag_s0y1B6jftOaw = (_MessageBoxA) GetProcAddress(hid_hHandl_jdWE73WT9RW9, hid_Messag_aMfLqtukSkIT);
hid_Messag_s0y1B6jftOaw(NULL, "Test", hid_Someth_stJfcgYpvJet, MB_OK);

    f_NtMapViewOfSection lNtMapViewOfSection;
    HMODULE ntdll;

    if (!(ntdll = LoadLibrary(hid_n_t_d__oFgOnee1Aswg)))
    {
        return -1;
    }

    lNtMapViewOfSection = (f_NtMapViewOfSection)GetProcAddress(ntdll, hid_NtMapV_IMIEGotOcjhL);
    lNtMapViewOfSection(0,0,0,0,0,0,0,0,0,0);

    char return_value[500];
    sprintf(return_value, hid_____At_xJm6meSWRsVt, hid_userna_Ieu2HHqcBt5t, hid_dc_net_l1eEndAbTT0e);
    return 0;
}