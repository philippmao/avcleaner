//
// Created by vladimir on 28.09.19.
//

#include <Windows.h>
#include <stdio.h>


const char  hid_core_l_nFq7rtuzNTct[] = {'\x63','\x6f','\x72','\x65','\x5f','\x6c','\x6f','\x61','\x64','\x6c','\x69','\x62',0};

const char  hid_reques_86RVbB7Tvnya[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x6c','\x6f','\x61','\x64','\x6c','\x69','\x62',0};

const char  hid_core_e_sbnzERPkIcH1[] = {'\x63','\x6f','\x72','\x65','\x5f','\x65','\x6e','\x75','\x6d','\x65','\x78','\x74','\x63','\x6d','\x64',0};

const char  hid_reques_pP3HslV6Zhhv[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x65','\x6e','\x75','\x6d','\x65','\x78','\x74','\x63','\x6d','\x64',0};

const char  hid_core_m_ucc4XHsNIQoP[] = {'\x63','\x6f','\x72','\x65','\x5f','\x6d','\x61','\x63','\x68','\x69','\x6e','\x65','\x5f','\x69','\x64',0};

const char  hid_reques_Sn72N4hNQt1z[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x6d','\x61','\x63','\x68','\x69','\x6e','\x65','\x5f','\x69','\x64',0};

const char  hid_core_g_AxrKL0r26ZTA[] = {'\x63','\x6f','\x72','\x65','\x5f','\x67','\x65','\x74','\x5f','\x73','\x65','\x73','\x73','\x69','\x6f','\x6e','\x5f','\x67','\x75','\x69','\x64',0};

const char  hid_reques_e2tyBiYbLPfN[] = {'\x72','\x65','\x71','\x75','\x65','\x73','\x74','\x5f','\x63','\x6f','\x72','\x65','\x5f','\x67','\x65','\x74','\x5f','\x73','\x65','\x73','\x73','\x69','\x6f','\x6e','\x5f','\x67','\x75','\x69','\x64',0};
char *customCommands[] =
{
	hid_core_l_nFq7rtuzNTct,
    hid_reques_86RVbB7Tvnya,
	hid_core_e_sbnzERPkIcH1,
    hid_reques_pP3HslV6Zhhv,
	hid_core_m_ucc4XHsNIQoP,
    hid_reques_Sn72N4hNQt1z,
	hid_core_g_AxrKL0r26ZTA,
    hid_reques_e2tyBiYbLPfN
};

typedef NTSTATUS (NTAPI *f_NtMapViewOfSection)(HANDLE, HANDLE, PVOID *, ULONG, ULONG,
PLARGE_INTEGER, PULONG, ULONG, ULONG, ULONG);
typedef NTSTATUS (* PKUHL_M_C_FUNC) (int argc, wchar_t * args[]);
typedef NTSTATUS (* PKUHL_M_C_FUNC_INIT) ();

typedef struct _KUHL_M_C {
    const PKUHL_M_C_FUNC pCommand;
    const wchar_t * command;
    const wchar_t * description;
} KUHL_M_C, *PKUHL_M_C;

int main(void)
{

    
	const char  hid_Someth_8qjnUcAC0nFV[] = {'\x53','\x6f','\x6d','\x65','\x74','\x68','\x69','\x6e','\x67',0};

	TCHAR  hid_n_t_d__B6xtGaJtqmGn[] = {'\x6e','\x74','\x64','\x6c','\x6c',0};

	const char  hid_NtMapV_uSzK6hHjlAVt[] = {'\x4e','\x74','\x4d','\x61','\x70','\x56','\x69','\x65','\x77','\x4f','\x66','\x53','\x65','\x63','\x74','\x69','\x6f','\x6e',0};

	const char  hid_____At_iGMK3WrnUwcG[] = {'\x5b','\x2a','\x5d','\x20','\x41','\x74','\x74','\x65','\x6d','\x70','\x74','\x69','\x6e','\x67','\x20','\x74','\x6f','\x20','\x61','\x64','\x64','\x20','\x75','\x73','\x65','\x72','\x20','\x25','\x73','\x20','\x74','\x6f','\x20','\x68','\x6f','\x73','\x74','\x20','\x25','\x73','\n',0};

	const char  hid_userna_HDOr5cOQ8U04[] = {'\x75','\x73','\x65','\x72','\x6e','\x61','\x6d','\x65',0};

	const char  hid_dc_net_iagsdTkbWnGh[] = {'\x64','\x63','\x5f','\x6e','\x65','\x74','\x62','\x69','\x6f','\x73','\x5f','\x6e','\x61','\x6d','\x65',0};
	typedef int (*_MessageBoxA)(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType);
	TCHAR hid_User___37avabi8pgOJ[] = {'\x55','\x73','\x65','\x72','\x33','\x32','\x2e','\x64','\x6c','\x6c',0};

	HANDLE hid_hHandl_L8CYF6XnCvPY = LoadLibrary(hid_User___37avabi8pgOJ);
	TCHAR hid_Messag_VtH29hUGUBic[] = {'\x4d','\x65','\x73','\x73','\x61','\x67','\x65','\x42','\x6f','\x78','\x41',0};

	_MessageBoxA hid_Messag_zLGtm3NAvko8 = (_MessageBoxA) GetProcAddress(hid_hHandl_L8CYF6XnCvPY, hid_Messag_VtH29hUGUBic);
hid_Messag_zLGtm3NAvko8(NULL, "Test", hid_Someth_8qjnUcAC0nFV, MB_OK);

    f_NtMapViewOfSection lNtMapViewOfSection;
    HMODULE ntdll;

    if (!(ntdll = LoadLibrary(hid_n_t_d__B6xtGaJtqmGn("ntdll"))))
    {
        return -1;
    }

    lNtMapViewOfSection = (f_NtMapViewOfSection)GetProcAddress(ntdll, hid_NtMapV_uSzK6hHjlAVt);
    lNtMapViewOfSection(0,0,0,0,0,0,0,0,0,0);

    char return_value[500];
    sprintf(return_value, hid_____At_iGMK3WrnUwcG, hid_userna_HDOr5cOQ8U04, hid_dc_net_iagsdTkbWnGh);
    return 0;
}